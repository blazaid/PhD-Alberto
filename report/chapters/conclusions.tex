\chapter{Conclusiones y líneas de investigación futuras}
\label{ch:conclusions}

La aplicación de técnicas de la \acrlongsp{ci} sobre el área de la conducción y, concretamente, al área del comportamiento es una línea de investigación muy prometedora. Es posible la extracción de comportamientos específicos a partir de datos reales de conducción e incorporar el factor indeterminado de éstos en modelos basados en redes neuronales.

Las implicaciones de estos resultados son variadas. Aun con las limitaciones que nos imponen los micro-simuladores\index{micro-simulación}, es posible modelar los comportamientos longitudinal y lateral a partir de datos reales con precisión suficiente como para decir que los agentes se comportan de manera más humana.

\section{Objetivos planteados}

Al comienzo de la tesis se plantearon una serie de objetivos materializados en dos hipótesis que se han tratado de demostrar a lo largo de esta tesis.

La hipótesis H\ref{hyp:first} planteaba que la aplicación de técnicas pertenecientes al campo de la \acrlongsp{ci} con datos de conductores reales sí permite la creación de modelos de conducción con características humanas. A tenor de los resultados obtenidos, se concluye que se pueden desarrollar modelos con la técnica propuesta para incorporar comportamientos no deducibles directamente con un modelo determinista en simuladores de tráfico.

La hipótesis~H\ref{hyp:second} proponía, por otro lado, que estas técnicas eran suficientes para modelar un conductor en concreto dentro de entornos simulados. Si bien es cierto que los resultados indican que los modelos generados para conductores diferentes son diferentes entre sí, y que sugieren que los modelos simulados se aproximan a sus modelos reales, concretamente en el caso del modelo lateral creemos que sería necesaria la captura de nuevos parámetros para ajustar mejor este comportamiento lateral.

Por tanto, podemos concluir que es posible incorporar características humanas sobre los modelos de conductor para hacer las simulaciones más fieles a la realidad. Sin embargo, a la hora de modelar conductores en particular, aunque se ha podido extraer comportamiento personalizado, consideramos que no es suficiente para ser usado como fuente para la comparación objetiva de dos conductores.

Somos optimistas, no obstante, a que esta conclusión es debida a la dificultad de hacer corresponder los datos de la realidad con los datos disponibles desde el simulador, y por tanto el uso de simuladores que ofrezcan un entorno más parecido a la realidad permitirán que la aplicación de estas técnicas sí permitan la comparación entre diferentes conductores.

\section{Sobre los datos, los sensores y su utilidad}

Para minimizar la variación de las variables de entrada, los recorridos fueron planteados con ciertos factores a tener en cuenta (e.g. misma hora, día de la semana, meteorología, velocidades máximas de vía, etcétera) para mantener un conjunto de datos lo más parecido posible entre sujetos, y así minimizar en la medida de lo posible la incorporación de imprecisiones o sesgos a los conjuntos de datos. Los dispositivos además fueron configurados de la forma más precisa posible, y su sincronización establecida a su menor frecuencia para acercar lo máximo posible sus valores entre sí, a fin de minimizar el error temporal entre medidas.

Con todo, la captura en este tipo de entornos es una tarea compleja, y más tratándose de tráfico. Los recorridos no están exentos de situaciones fortuitas no predecibles y los dispositivos no son lo suficientemente precisos para capturar los datos de interés. En nuestro caso concreto, consideramos que:

\begin{itemize}
	\item La precisión de un único \acrshort{lidar}\index{LiDAR} de 16 capas no es suficientemente adecuada para capturar las características del entorno necesarias para modelar un comportamiento humano. Una separación de \SI{2}{\degree} por capa hace que a \SI{15}{\meter} las capas estén separadas algo más de \SI{0.5}{\meter}, lo cual es insuficiente para muchos usos\sidenote{
		Por ejemplo, sobre una persona de \SI{1.80}{\meter} a una distancia de \SI{20}{\meter} alcanzarían únicamente $2$ haces a lo sumo. Quizá la incorporación de más dispositivos de este tipo en configuraciones con haces cruzados podrían ayudar a esta tarea.
	}
	\item En el caso del \Acrshort{gps}, aun con alta precisión y corrección diferencial implementada, es arriesgado su uso como único dispositivo de localización y para determinar velocidades en entorno urbano.
\end{itemize}

Acerca de los datos, los mapas de profundidad obtenidos han demostrado ser una herramienta válida para la representación de un entorno a pesar de su baja resolución.

La técnica del \textit{mirroring} es muy usada en el dominio de reconocimiento de imágenes. Sin embargo, y aunque en nuestro caso está justificada\sidenote{
	La normativa indica que el carril por el que se debe circular en circuito urbano es el que más convenga para su destino, a diferencia de vías como una autopista.
}, puede ser contraproducente en el caso de querer extraer información del comportamiento de conductores en entornos extra-urbanos, ya que en éstos, tanto el carril por el que se circula como los cambios sí se pueden considerar dependientes del sentido de la circulación.

Por otro lado, la técnica propuesta del \textit{shaking} ha sido extremadamente útil en la generación artificial de datos y además no sufre del problema del \textit{mirroring} de los entornos no urbanos. Consideramos que esta técnica, en conjuntos de datos donde existe un cierto grado de error o imprecisión, es capaz de incrementar su tamaño ayudando a mejorar la generalización y, por tanto, la calidad de los resultados obtenidos.

\section{Sobre las técnicas de \acrlongsp{ci}}

Las técnicas utilizadas (\acrlongsp{cnn}\index{red de convolución}, \acrlongsp{fcs}\index{sistema de control borroso} y \acrlongsp{mlp}\index{perceptron multicapa}) dependen mucho de las variables seleccionadas, y no sólo de la cantidad de datos. De nada sirve ofrecer datos de una variable que no tiene impacto sobre el resultado que se quiere alcanzar. La selección de variables realizada en esta tesis se ha basado en la disponibilidad de sus datos asociados en ambos entornos (real y simulación), tratando de obtener de formas alternativas los más críticos (e.g. implementando un \acrshort{lidar}\index{LiDAR} dentro de un simulador, calculando la distancia que se puede recorrer en los carriles).

La aplicación del descenso del gradiente para el ajuste de un \acrlongsp{fcs}\index{sistema de control borroso} permite de forma rápida encontrar un controlador óptimo para un problema. Sin embargo el problema del modelo longitudinal no es directamente tratable con un controlador, al menos no con las variables planteadas y el conjunto de datos. No obstante, creemos que aumentando la precisión de los datos obtenidos y con un nuevo conjunto de variables más cercanas al entorno real, el desempeño de estos modelos aumentaría notablemente.

Para el trabajo con datos del entorno, se ha podido comprobar que las \acrlongplsp{cnn}\index{red de convolución} han generalizado mejor los resultados que los \acrlongplsp{mlp}\index{perceptron multicapa}. Después de todo el entorno se ha representado con una imagen, dominio en el que estas redes destacan por su capacidad de clasificación. Además, al incorporar la ventana temporal como canales de la imagen, toda información está localizada topológicamente cerca con sus momentos anteriores, por lo que es de esperar que esta representación sea capaz de converger más rápidamente hacia una solución. Esto, junto con la modificación de inyección de datos de entrada en capas posteriores a la extracción de características, hace que las \acrlongplsp{cnn}\index{red de convolución} se hayan comportado mejor en su tarea de clasificación.

Concluimos por tanto que las \acrlongplsp{cnn}\index{red de convolución}, en tareas donde es importante la topología espacial y temporal de las entradas, son extremadamente eficientes a la hora de modelar eventos donde sus ventanas temporales están localizadas lo suficientemente cerca en el tiempo como para que sus patrones se desplacen ligeramente, mejorando mucho en precisión y capacidad de caracterización de las entradas a los \acrlongplsp{mlp}\index{perceptron multicapa}.

Somos optimistas en que la implementación de estas técnicas en simuladores más potentes y realistas mejorarían los resultados obtenidos, y por ello es una de las líneas futuras de investigación propuestas.

\section{Sobre el entorno de simulación}

\gls{sumo}\index{SUMO} es un entorno de simulación de tráfico muy potente a la hora de simular escenarios de tráfico complejo. Sin embargo, para comportarse de esta manera, tiene que simplificar otros aspectos. El realismo se queda en la faceta de tráfico, ya que en la faceta de conductor no existe apenas complejidad. El entorno en el que circulan los vehículos no es realista (e.g. no hay edificios), los carriles son vías por las que circulan los vehículos, los cambios de carril son una \textit{\enquote{teleportación}}, y así un largo etcétera.

En la captura de datos ha sido necesario un proceso previo de muchos de esos datos para convertirlos a algo lo más parecido posible a lo que sería recuperable bajo el entorno simulado, y esas concesiones son las que hacen que se pierda fidelidad en el conjunto de datos capturado.

La conclusión a la que hemos llegado tras trabajar intensivamente es que el entorno es muy adecuado para trabajar otros aspectos de los \acrshort{its}\index{ITS} tales como comportamientos colaborativos, comunicaciones, planificación vial, cálculo de rutas óptimas, etcétera. Para trabajar el comportamiento de un conductor dentro de simuladores de tráfico, sin embargo, necesitamos otras aproximaciones donde el entorno presentado a los agentes sea más realista.

\section{Propuestas de líneas de investigación futuras}

\subsection{Entornos de simulación más realistas}

Para simular conductores en entornos de simulación es necesario que estos sean lo suficientemente potentes como para presentar un escenario realista al agente que va a modelar al conductor.

Sería muy interesante evaluar las mismas técnicas en otros entornos de simulación. Una opción sería el uso de entornos de conducción de tipo \ac{torcs} adaptados a la simulación de tráfico, como por ejemplo el simulador de 3DCoAutoSim \cite{olaverri2018implementation} con el que se ha tenido la suerte de trabajar en una estancia durante la realización de esta tesis. Otras opciones serían, incluso, el uso de videojuegos con entornos de tráfico incorporados\sidenote{
	Está habiendo una tendencia en los últimos años de hacer aprender a agentes a jugar a todo tipo de videojuegos a partir de la lectura en crudo de la pantalla y actuando sobre los controles del juego. Uno de éstos juegos titulado Grand Theft Auto V incorpora una simulación de una ciudad entera con peatones, señales de tráfico, vehículo y un punto de vista de cámara desde el interior del vehículo. Dos lecturas interesantes sobre este fenómeno son \cite{richter2016playing, johnson2017driving}, las cuales ahondan en la recuperación de datos a partir de videojuegos y de hasta qué punto pueden llegar a reemplazar datos reales.
}.

La aplicación de estas técnicas en el modelado de agentes en estos entornos propiciaría la investigación en otras áreas más orientadas a factores humanos, ya que el comportamiento de los conductores sería más realista.

\subsection{Modelado de diferentes actores y escenarios}

En esta tesis se trabaja sobre todo con el comportamiento longitudinal y lateral de conductores, sin tener en cuenta casos específicos de comportamiento que merecería la pena explorar por separado. Algunos ejemplos de éstos pueden ser intersecciones más o menos complejas, rotondas, incorporaciones a vías, etcétera.

Además, los conductores de turismos no son los únicos agentes existentes en el sistema que es el tráfico. En general se tiende a prestar poca atención a los vehículos pesados, pero su conducción y comportamiento es muy diferente a la de un turismo. Existen también motos, bicicletas e incluso peatones.

Otro objetivo de modelado podría ser también las emisiones en vehículos. Actualmente, los simuladores incorporan modelos de emisión para simular de qué manera los vehículos producen emisiones. Los sistemas más completos (como \gls{sumo}\index{SUMO}) implementan las tipologías descritas en el \gls{hbefa}~\cite{de2004modelling}, pero no dejan de ser modelos que generalizan tipologías de vehículos y se alejan de la realidad. Creemos que las emisiones de los vehículos podrían ser modelables a partir de sus datos reales con técnicas de \ac{ci}.

\subsection{\Acrlongplsp{rnn}\index{redes neuronales recurrentes}}

El estudio se ha limitado a redes de tipo \textit{\idx{feed-forward}}, representando la evolución del tiempo como ventanas de datos temporales. Este tipo de redes no ven más allá de su ventana temporal, y puede no ser suficiente para determinados modelos. Sin embargo, éste es un primer paso necesario para comprobar que es posible modelar el problema.

Con este resultado, el siguiente paso lógico sería el uso de arquitecturas de \acrlongplsp{rnn}\index{redes neuronales recurrentes} para incorporar capacidad de comprender la continuidad temporal en el flujo de datos que percibe el agente. Quizá de esta manera se podrían captar características tales como la percepción temporal de velocidades de aproximación a obstáculos o impaciencia en función de otros factores.